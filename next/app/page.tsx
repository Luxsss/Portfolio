"use client";

import { useEffect, useRef } from "react";
import gsap from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";
import Navbar from "@/components/Navbar";
import Header from "@/components/Header";
import AboutMe from "@/components/AboutMe";
import Projects from "@/components/Projects";
import Contact from "@/components/Contact";
import Footer from "@/components/Footer/index"

export default function Home() {
  const svgRefDesktop = useRef<SVGSVGElement | null>(null);
  const pathRefDesktop = useRef<SVGPathElement | null>(null);
  const svgRefMobile = useRef<SVGSVGElement | null>(null);
  const pathRefMobile = useRef<SVGPathElement | null>(null);

  useEffect(() => {
    gsap.registerPlugin(ScrollTrigger);

    // Détermine si l'affichage est mobile
    const isMobile = window.innerWidth <= 425;
    const svg = isMobile ? svgRefMobile.current : svgRefDesktop.current;
    const path = isMobile ? pathRefMobile.current : pathRefDesktop.current;
    if (!svg || !path) return;

    // Indique que stroke-dashoffset sera animé
    path.style.willChange = "stroke-dashoffset";

    // Récupère la longueur totale du tracé
    const pathLength = path.getTotalLength();

    // Initialise le tracé pour créer l’effet "draw"
    path.style.strokeDasharray = `${pathLength}`;
    path.style.strokeDashoffset = `${pathLength}`;

    // Animation avec GSAP et ScrollTrigger
    gsap.to(path, {
      strokeDashoffset: 0,
      ease: "none",
      scrollTrigger: {
        trigger: svg,
        start: "top",
        end: `+=${svg.clientHeight / 1.08}`,
        scrub: true,
      },
    });
  }, []);

  return (
    <div>
      <Navbar />
      <Header />
      <AboutMe />
      <Projects />
      <Contact />
      <Footer />

      <svg ref={svgRefDesktop} className="olk squiggle first-svg" width="2150" height="16910" viewBox="0 0 2150 16910" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path ref={pathRefDesktop} d="M0 48.6744C13.42 -63.1605 526.905 243.931 331.243 494.416C135.582 744.901 99.6253 1014.71 150.444 1181.93C201.263 1349.15 387.432 1630.87 693.352 1643.65C999.273 1656.43 934 1944.88 271.705 2381.76C-363.865 2885.26 871.702 2814.53 810.588 3118.28C749.474 3422.02 1631.38 3174.04 1883.83 3500.64C2136.27 3827.25 -701.664 3911.98 271.705 4157.27C1245.07 4402.57 1502.48 4643.81 810.588 5201.06C118.695 5758.31 1210.13 5215.71 1708.73 4944.38C2207.33 4673.05 2144.46 5865.68 1804.83 5683.02C1465.2 5500.36 334.696 7317.42 250.573 6416.87C166.449 5516.31 1217.94 6843.76 1649.86 7035.69C2514.13 7507.69 829.205 7500.07 596.746 7564.51C364.287 7628.95 197.155 7673.93 179.628 7849.42C162.1 8024.9 1199.2 8768.5 1207.08 8269.6C1214.96 7770.7 1743.79 8364.06 1870.24 8506.58C1996.69 8649.1 2092.62 8811.05 1913.51 8760.07C1734.4 8709.1 1691.67 8997.59 1675.01 9277.7C1658.35 9557.81 692.161 9311.1 485.045 9381.56C277.929 9452.01 52.3285 9559.43 153.463 9854.46C254.598 10149.5 1018.9 10331.3 1040.03 10104.2C1061.16 9877.11 1540.17 10148.4 1675.01 10462.6C1809.86 10776.8 1246.53 10330.6 1061.16 10542C875.794 10753.3 1040.03 11229 1040.03 11394.1C1040.03 11559.1 841.784 11598 775.87 11229C709.957 10859.9 435.112 11757.2 249.063 11751.9C63.0146 11746.6 -298.876 12428.8 979.649 12314.3C2258.18 12199.8 2349.75 12714.2 1675.01 12507.6C1000.28 12301 -533.851 13004.5 253.089 12956C1040.03 12907.5 1328.34 12995.4 709.957 13377.8C91.5749 13760.2 1598.03 13500.8 1760.05 13869.9C1922.07 14238.9 967.071 14127.7 1004.81 14322.5C1042.54 14517.4 1348.31 14249.2 1407.33 14467.4C1466.36 14685.6 992 14558.2 1004.81 14656.4C1017.61 14754.6 1310.62 14879.3 967.071 14911.5C623.526 14943.8 361 14937 316 15256.5C271 15576 972.735 15912.7 1125.77 15665.7C1278.81 15418.7 2244.52 15788.7 1864.93 15821.7C1485.34 15854.7 740.272 16192.2 1242.29 16157.2C1744.3 16122.2 2263.54 16371.1 800.686 16404.7C-662.165 16438.3 1686.45 16918.1 2154 16883.2" stroke="#CE4242" strokeWidth="50"/>
      </svg>

      <svg ref={svgRefMobile} className="olk squiggle second-svg" width="2149" height="23770" viewBox="0 0 2149 23770" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path ref={pathRefMobile} d="M0 48.6744C13.42 -63.1605 526.905 243.931 331.243 494.416C135.582 744.901 99.6253 1014.71 150.444 1181.93C201.263 1349.15 387.432 1630.87 693.352 1643.65C999.272 1656.43 934 1944.88 271.705 2381.76C-363.865 2885.26 871.702 2814.53 810.588 3118.28C749.474 3422.02 1865.15 3080.79 1883.83 3500.64C1902.5 3920.5 533.128 3586.26 271.705 4157.27C10.2833 4728.29 829.171 4821.42 810.588 5201.06C792.005 5580.7 1151.26 5593.83 1649.86 5322.5C2148.46 5051.17 2150 6364 1824.5 6045C1499 5726 -112.606 6492.37 436.5 6554.5C985.606 6616.63 1217.94 6843.76 1649.86 7035.69C2514.13 7507.69 829.205 7500.07 596.746 7564.51C364.287 7628.95 110.192 7551.34 179.627 7849.42C249.063 8147.5 1199.2 8768.5 1207.08 8269.6C1214.96 7770.7 1743.79 8364.06 1870.24 8506.58C1996.69 8649.1 2090.51 8788.57 1923.5 8926.5C1756.49 9064.43 1440.11 8878.6 1675.01 9277.7C1909.92 9676.8 306.79 8944.7 580.645 9466.6C854.5 9988.5 245.038 9678 249.063 9939.5C253.089 10201 1018.9 10331.3 1040.03 10104.2C1061.16 9877.11 1540.17 10148.4 1675.01 10462.6C1809.86 10776.8 1246.53 10330.6 1061.16 10542C875.795 10753.3 1040.03 11229 1040.03 11394.1C1040.03 11559.1 893.886 11392.1 580.645 11348C267.404 11303.9 482.172 11836.6 253.089 11843.5C24.0057 11850.4 -258.484 12768.2 979.649 12314.3C2217.78 11860.4 2194.74 12992.1 1520 12785.5C845.264 12578.9 -243.94 13237.5 543 13189C1329.94 13140.5 1118.88 13487.5 500.5 13869.9C-117.882 14252.2 1598.03 13500.8 1760.05 13869.9C1922.07 14238.9 967.07 14127.7 1004.81 14322.5C1042.54 14517.4 1348.31 14249.2 1407.33 14467.4C1466.36 14685.6 748.5 14378.5 748.5 14704C748.5 15029.5 1004.81 14845.5 1095 15079.5C1185.19 15313.5 662.665 15068.8 355.082 15212.2C47.5 15355.5 1010.73 15857.2 1163.77 15610.2C1316.81 15363.2 1852.5 15624.5 1711 16106C1569.5 16587.5 381.5 17145 267 16757.5C152.5 16370 1864.93 16633 1864.93 17008C1864.93 17383 1372.5 17283.5 1651.5 17820.5C1930.5 18357.5 51.0001 17820.5 387.5 18290.5C724 18760.5 -63 18811 229 19090.5C521 19370 1630.5 18903 1300.5 19391.5C970.5 19880 770.5 20006 1520 20361.5C2269.5 20717 197.5 20773.5 159 21021C120.5 21268.5 1321 21376.5 1804 21332C2287 21287.5 1702 22107 572 22164C-558 22221 730.5 22856 1257.5 22595.5C1784.5 22335 1836 23180 997.5 23097.5C159 23015 1397.66 23693.3 2146.5 23745" stroke="#CE4242" strokeWidth="50"/>
      </svg>

    </div>
  );
}
